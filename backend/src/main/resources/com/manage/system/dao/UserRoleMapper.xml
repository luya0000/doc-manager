<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.manage.system.dao.UserRoleMapper">

    <insert id="insert" parameterType="com.manage.system.model.UserRoleGroupDto">
      insert into t_user_role_group
        (user_id, role_id, group_id, create_time, create_user)
	  values
	    (#{userId,jdbcType=INTEGER},#{roleId,jdbcType=INTEGER},#{groupId,jdbcType=INTEGER},data,#{createUser,jdbcType=VARCHAR})
    </insert>

    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
        DELETE FROM t_user_role_group WHERE ID = #{id,jdbcType=INTEGER}
    </delete>

    <delete id="deleteByParam">
        DELETE FROM t_user_role_group
        <where>
            <if test="userId != null">user_id = #{userId,jdbcType=INTEGER}</if>
            <if test="roleId != null">AND role_id = #{userId,jdbcType=INTEGER}</if>
            <if test="groupId != null">AND group_id = #{userId,jdbcType=INTEGER}</if>
        </where>
    </delete>

    <select id="selectByParam" resultType="com.manage.system.model.UserRoleGroupDto">
        SELECT tu.id, tu.user_id, tu.role_id, tu.group_id, tr.type as role_type ,tu.create_time, tu.create_user
        FROM t_user_role_group tu, t_role tr
        <where>
            tu.role_id = tr.id
            <if test="userId != null">AND tu.user_id = #{userId,jdbcType=VARCHAR}</if>
            <if test="roleId != null">AND tu.role_id = #{roleId,jdbcType=INTEGER}</if>
            <if test="groupId != null">AND tu.group_id = #{groupId,jdbcType=INTEGER}</if>
        </where>
    </select>

</mapper>